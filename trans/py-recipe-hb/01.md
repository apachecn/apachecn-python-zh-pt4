# 1.字符串和文本

自从计算的早期以来，计算中使用的数据存储在基本的文本文件中。任何编写过 shell 脚本的人都非常清楚，Unix 系统及其实用程序是基于这样一种假设构建的，即处理文本将是程序的大部分工作。Python 也不例外；它提供了几个编程元素来帮助完成基本的文本处理任务。

首先，让我们注意一下 Python 是如何存储字符串的。字符串是不可变的列表，所以它们不能被改变。对字符串内容的任何更改都需要复制到内存中的新位置。当您试图优化代码的任何文本处理部分时，您必须始终牢记这一点。

## 1-1.串联字符串

### 问题

你想用一些更小的字符串来构建字符串。这个过程称为串联。

### 解决办法

构建字符串最简单的方法是使用`+`操作符。在这种情况下，字符串被放在一起，并返回完整的新字符串。

### 它是如何工作的

清单 [1-1](#Par6) 展示了一个例子。

```
>>> new_str = "hello " + "world"
>>> print(new_str)
hello world
Listing 1-1.Basic Concatenation

```

这段代码返回字符串“hello world”。如果希望两个单词之间有一个空格，需要显式地给其中一个字符串添加一个空格。

您也可以从一个较小字符串的多个副本创建字符串。这是通过使用`*`操作符并乘以您想要的副本数来完成的。参见清单 [1-2](#Par9) 中的示例。

```
>>> new_str = "Hello" * 3
>>> print(new_str)
HelloHelloHello
Listing 1-2.
Multiplicative Concatenation

```

这将返回字符串“HelloHelloHello”。

当您只处理字符串时，这两个操作符工作得很好。如果您想使用其他数据类型，您可以使用上面的例子，首先将您的数据传递到函数`str()`中。通过这种方式，您可以将数字添加到构造的字符串中。清单 [1-3](#Par12) 中显示了一个例子。

```
>>> New_str = "Count = " + str(42)
>>> print(New_str)
Count = 42
Listing 1-3.Concatenating Non-Strings

```

## 1-2.比较字符串

### 问题

您想要比较字符串，检查两个字符串是否具有相同的值，或者检查两个名称是否指向同一个 string 对象。

### 解决办法

有两种方法进行比较，使用`is`或使用`==`。第一种是测试两个变量名是否引用同一个对象的方法，第二种是比较每个变量的实际值的方法。

### 它是如何工作的

要测试相同的文本是否存储在两个独立的字符串中，使用类似清单 [1-4](#Par16) 中的代码。

```
str1 = "Hello"
str2 = "World"
if str1 == str2:
     print("The strings are equal")
else:
     print("The strings are not equal")
Listing 1-4.Comparing Strings

```

此代码返回“字符串不相等”。您可以使用任何常用的比较运算符，如`!=`、`<`或`>.`

Note

当进行大于或小于比较时，字符串是逐字母比较的。另外，Python 对待大写字母和小写字母的方式不同。大写字母在小写字母之前，所以 Z 在 a 之前。

## 1-3.搜索子字符串

### 问题

你想在一个字符串对象中搜索一个子串。

### 解决办法

您可以使用`in`操作符来检测子字符串是否存在。您可以通过使用 string 对象的`find()`方法来定位该子字符串的起始索引。

### 它是如何工作的

在 Python 中，有一个名为`in`的多态操作符，可以用来查看一个数据元素是否存在于一个更大的数据元素集合中。当您需要查看一个子字符串是否存在于另一个 string 对象中时，这也是可行的。清单 [1-5](#Par22) 中给出了用法。

```
>>> Str1 = 'This is a string'
>>> 'is' in Str1
True
>>> 'me' in Str1
False
Listing 1-5.Looking for a Substring

```

如您所见，它返回一个布尔值，告诉您是否找到了子串。如果需要查找子字符串的位置，请使用 string 对象的 find 方法。使用上面的代码，您可以使用

```
>>> Str1.find('is')
2
>>> Str1.find('me')
-1
Listing 1-6.Finding the Index of a Substring

```

这段代码返回子字符串第一个实例的索引。如果要查找其他实例，可以包含一个开始和/或结束索引值，以便进行搜索。因此，要找到第二个实例`is`，使用清单 [1-7](#Par26) 中的代码。

```
>>> Str1.find('is', 3)
5
Listing 1-7.Finding a Substring Beyond the First One

```

## 1-4.获取子字符串

### 问题

你需要从一个字符串对象中获取一个子串。

### 解决办法

一旦找到子字符串的索引，就可以通过复制原始字符串的一部分来获得它。这是通过使用切片符号从字符串中获取元素来实现的。

### 它是如何工作的

切片由开始索引和结束索引定义。要获取字符串中的第一个单词，您可以使用清单 [1-8](#Par30) 中显示的任一选项。

```
>>> Str2 = 'One two three'
>>> Str2[0:2]
On
>>> Str2[:2]
On
>>> Str2[8:]
three
Listing 1-8.Slice Notation

```

Note

切片适用于 Python 中的所有列表。您还可以使用负索引值来向后计数，而不是向前计数。

## 1-5.替换文本匹配

### 问题

你需要用新的内容替换字符串的一部分。

### 解决办法

因为 Python 字符串是不可变的，所以替换子字符串需要将原始字符串切碎，然后将所有内容重新连接成一个新字符串。

### 它是如何工作的

让我们使用上述切片和拼接的例子，并将它们放在一起，如清单 [1-9](#Par35) 所示。

```
>>> str1 = "Here are a string"
>>> corrected_str1 = str1[:5] + "is" + str1[7:]
>>> print(corrected_str1)
Here is a string
Listing 1-9.Manual String Replacement

```

string 对象包含一个名为`replace()`的方法，该方法也可以用来替换一个或多个子字符串实例。您需要提交旧的子串、要替换的新子串以及要替换的实例数。参见清单 [1-10](#Par37) 。

```
>>> corrected_str1 = str1.replace("are", "is", 1)
Listing 1-10.Using the replace() Function

```

如果省略 count，此方法将替换字符串中的每个实例。

## 1-6.反转字符串

### 问题

你需要反转一个字符串对象的内容。

### 解决办法

反转字符串可以通过使用切片符号以相反的顺序选择出单个字符来完成。

### 它是如何工作的

Python 包含了扩展切片的概念，它包含第三个参数来定义在列表中移动时的步幅长度。如果这个步幅长度是负的，您是在告诉 Python 向后遍历列表。反转字符串的一行程序类似于清单 [1-11](#Par42) 中的代码。

```
>>> str1 = "Hello World"
>>> str2 = str1[::-1]
>>> print(str2)
dlrow olleH
Listing 1-11.Reversing a String with Slices

```

因为这是一种特殊类型的切片，所以可以用它来获取一个子串，并在一个命令中全部反转。

## 1-7.修剪空白

### 问题

您需要从用户输入中删除空白。

### 解决办法

string 对象的`strip()`方法可以用来从字符串中删除任何多余的空白字符。

### 它是如何工作的

当您的代码需要接受来自用户的文本输入时，您通常需要能够修剪掉可能存在于字符串开头或结尾的任何空白字符。如果您希望简单地删除字符串开头和结尾的所有空白字符，您可以使用`strip()`方法。参见清单 [1-12](#Par47) 。

```
>>> str1 = "Space"
>>> str2 = str1.strip()
>>> print(str2)
Space
Listing 1-12.Stripping Whitespace

```

如果您想从字符串的开头和结尾去掉某个特定的字符，您可以将它作为参数传递给方法。您可以分别使用方法`lstrip()`或`rstrip()`从开头或结尾去掉不需要的字符。

## 1-8.改变大小写

### 问题

您需要将字符的大小写设置为全部大写或全部小写。

### 解决办法

方法可以对内容执行大小写更改。

### 它是如何工作的

处理用户输入时出现的另一个问题是，您可能需要将所有字符设置为大写或小写。这通常是对放入数据库的信息进行的，以简化两个值之间的比较。这样可以避免前面提到的大写和小写字符被区别对待的问题。在这两种情况下，这都是通过 string 对象提供的方法来完成的。参见清单 [1-13](#Par52) 。

```
>>> str1 = "Hello World"
>>> print(str1.lower())
hello world
>>> print(str1.upper())
HELLO WORLD
Listing 1-13.Changing the Case of a String

```

Note

你可以用方法`capitalize()`将一个字符串大写。

## 1-9.转换为数字

### 问题

您需要将用户输入的数字转换为数字数据类型。

### 解决办法

有一些转换函数可以将字符串转换成其他数据类型。对于数字，有`int()`、`float()`、`long()`和`complex()`函数。

### 它是如何工作的

这些函数接受一个字符串，并返回您所请求类型的数字。该字符串应该与直接在 Python 中输入的数字文字具有相同的形式。如果字符串与请求的类型转换的预期格式不匹配，将会出现错误。

默认的基数是 10。您可以输入不同的基数，以便创建不同的数字。例如，如果您正在输入十六进制数字，您可以使用清单 [1-14](#Par58) 中的代码。

```
>>> hex1 = int("ae", 16)
>>> hex1
174
Listing 1-14.Type Cast Functions

```

可能的基数是 2 到 36。

## 1-10.迭代字符串中的字符

### 问题

您需要遍历字符串对象的字符，并对每个字符应用一些处理。

### 解决办法

您可以使用一个`for`循环迭代每个字符。

### 它是如何工作的

如果您需要处理给定字符串的每个字符，那么您需要能够遍历该字符串。您可以构建一个简单的循环，使用索引并从列表中提取每个元素。参见清单 [1-15](#Par63) 。

```
str1 = "0123456789"
for i in range(10):
     print(str1[i], " and ")
Listing 1-15.Iterating Over a String

```

此代码返回文本“0 和 1 以及 2 和 3”。更 Pythonic 化的方法是使用迭代器。令人高兴的是，列表自动支持迭代器方法。代码可以更改为清单 [1-16](#Par65) 中的代码。

```
for i in str1:
     print(i, " and ")
Listing 1-16.Using an Iterator

```

## 1-11.文本统计

### 问题

您需要找到字符串对象的统计数据。

### 解决办法

如果您对查看给定字符串的总体统计信息感兴趣，可以使用几种不同的方法和函数来收集这类信息。

### 它是如何工作的

最基本的统计是字符串中的字符数，由函数`len()`给出。您可以使用函数`min()`和`max()`找到最小和最大字符值。要获得更详细的信息，您可以使用`count()`方法来查看某些字符在字符串中出现了多少次。见清单 [1-17](#Par69) 。

```
>>> str1 = "Hello world"
>>> len(str1)
11
>>> min(str1)
' '
>>> max(str1)
'w'
>>> str1.count('o')
2
Listing 1-17.String Statistics

```

## 1-12.编码 Unicode

### 问题

您需要将字符串编码为 Unicode。

### 解决办法

Python 曾经有一个`unicode`数据类型用于存储 Unicode 编码的字符串。从版本 3 开始，Python 字符串文字默认存储为 Unicode 字符串。

### 它是如何工作的

如果您使用的是 Python 3，标准字符串对象已经存储为 Unicode。如果您使用的是 Python 2，您可以通过使用构造函数或定义 Unicode 文字来创建它们。参见清单 [1-18](#Par73) 。

```
>>> ustr1 = unicode("Hello")
>>> ustr2 = u’Hello’
>>> ustr1 == ustr2
True
Listing 1-18.Using Unicode

```

Unicode 值实际上存储为整数。您可以将这些值编码成特定的编码字符串。举个例子，

```
ustr1.encode("utf-8")

```

给你一个编码为 UTF 8 的新字符串。您还可以使用`decode()`方法将这个字符串解码回普通的 Unicode 字符串。

## 1-13.翻译

### 问题

你需要翻译字符串的内容。

### 解决办法

您可以将翻译映射应用于整个字符串。如果你想完成几个替换，这是很方便的。

### 它是如何工作的

您可以使用字符串的`translate()`方法来应用这种映射。虽然您可以手动创建转换表，但是 string 数据类型包含一个名为`maketrans()`的帮助函数，它创建一个转换表，将第一个参数中的每个字符映射到第二个参数中相同位置的字符。如清单 [1-19](#Par80) 所示。

```
>>> str1 = "Hello world"
>>> translate_table = str1.maketrans("abcd", "efgh")
>>> str1.translate(translate_table)
Hello worlh
Listing 1-19.
Translating Strings

```

`translate`方法可选地接受第二个参数，该参数包含一组要从给定字符串中删除并执行翻译的字符。如果您希望能够从字符串中删除一组字符，可以通过将转换表设置为 None 来实现。这样，你就可以用清单 [1-20](#Par82) 中的代码去掉字符 l 和 w。

```
>>> str1.translate(str.maketrans({'l':None,'W':None}))
Heo ord
Listing 1-20.Using translate to Delete Characters

```